services:
  # LiveKit Server
  livekit:
    image: livekit/livekit-server:latest
    platform: linux/arm64
    command: --dev --bind 0.0.0.0
    ports:
      - "7880:7880"
      - "7881:7881"
      - "7882:7882/udp"
    environment:
      # NOTE: must include a space after the colon
      - "LIVEKIT_KEYS=jungle_livekit: R1AFmqiledAt0KbEpnK6OkZyEfgJ26FCPKrCNdg2"
    networks:
      - livekit-network

  # LiveKit Backend API
  livekit-backend:
    build: .
    ports:
      - "3001:3001"
    environment:
      - LIVEKIT_URL=http://livekit:7880
      - LIVEKIT_PUBLIC_URL=http://localhost:7880
      - LIVEKIT_API_KEY=jungle_livekit
      - LIVEKIT_API_SECRET=R1AFmqiledAt0KbEpnK6OkZyEfgJ26FCPKrCNdg2
      - PORT=3001
    depends_on:
      - livekit
    networks:
      - livekit-network

networks:
  livekit-network:
    driver: bridge
