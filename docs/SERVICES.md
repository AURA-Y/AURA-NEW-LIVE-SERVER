# ì„œë¹„ìŠ¤ ìƒì„¸

## ğŸ“ ëª¨ë“ˆ êµ¬ì¡°

```
src/
â”œâ”€â”€ livekit/     # LiveKit í†µí•©
â”œâ”€â”€ stt/         # ìŒì„±â†’í…ìŠ¤íŠ¸
â”œâ”€â”€ llm/         # LLM
â””â”€â”€ tts/         # í…ìŠ¤íŠ¸â†’ìŒì„±
```

---

## ğŸ¥ LivekitModule

**ìœ„ì¹˜:** `src/livekit/`

### LivekitService

ë°© ìƒì„±, ì…ì¥, í† í° ë°œê¸‰ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.

| ë©”ì„œë“œ | ì„¤ëª… |
|--------|------|
| `createRoom(dto)` | ìƒˆ ë°© ìƒì„± |
| `joinRoom(dto, isBot?)` | ë°© ì…ì¥ í† í° ë°œê¸‰ |
| `listRooms()` | ë°© ëª©ë¡ ì¡°íšŒ |
| `getRoom(id)` | ë°© ì •ë³´ ì¡°íšŒ |

**isBot ì˜µì…˜:**
- `true`: ìˆ¨ê¹€(hidden), êµ¬ë…ë§Œ ê°€ëŠ¥ (canPublish=false)
- `false`: ì¼ë°˜ ì°¸ê°€ì ê¶Œí•œ

---

### VoiceBotService

AI ë´‡ì´ ë°©ì— ì…ì¥í•˜ì—¬ ìŒì„±ìœ¼ë¡œ ëŒ€í™”í•©ë‹ˆë‹¤.

| ë©”ì„œë“œ | ì„¤ëª… |
|--------|------|
| `startBot(room, token)` | ë´‡ ì‹œì‘ |
| `stopBot(room)` | ë´‡ ì¢…ë£Œ |
| `isActive(room)` | ë´‡ í™œì„± ìƒíƒœ |

**ë‚´ë¶€ ì²˜ë¦¬ íë¦„:**

```
1. room.connect() â†’ LiveKit ë°© ì…ì¥
2. RoomEvent.TrackSubscribed â†’ ì˜¤ë””ì˜¤ íŠ¸ë™ êµ¬ë…
3. AudioStream(track, 16000, 1) â†’ 16kHz PCM ë³€í™˜
4. ì¹¨ë¬µ ê°ì§€ â†’ ë§ì´ ëë‚˜ë©´ ì²˜ë¦¬
5. STT â†’ LLM â†’ TTS íŒŒì´í”„ë¼ì¸
6. (TODO) ìŒì„± ì‘ë‹µ ì „ì†¡
```

---

## ğŸ¤ SttModule

**ìœ„ì¹˜:** `src/stt/`

### SttService

AWS Transcribe Streamingì„ ì‚¬ìš©í•˜ì—¬ ìŒì„±ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

| ë©”ì„œë“œ | ì„¤ëª… |
|--------|------|
| `transcribeFromBuffer(buffer, name)` | ë²„í¼ì—ì„œ STT ìˆ˜í–‰ |

**ì„¤ì •:**
- ì–¸ì–´: í•œêµ­ì–´ (ko-KR)
- ìƒ˜í”Œë ˆì´íŠ¸: 16kHz
- ì¸ì½”ë”©: PCM

---

## ğŸ§  LlmModule

**ìœ„ì¹˜:** `src/llm/`

### LlmService

AWS Bedrock Claudeë¥¼ ì‚¬ìš©í•˜ì—¬ AI ì‘ë‹µì„ ìƒì„±í•©ë‹ˆë‹¤.

| ë©”ì„œë“œ | ì„¤ëª… |
|--------|------|
| `sendMessage(text)` | LLMì— ë©”ì‹œì§€ ì „ì†¡ |

**ì„¤ì •:**
- ëª¨ë¸: `anthropic.claude-3-haiku-20240307-v1:0`
- ìµœëŒ€ í† í°: 1000

---

## ğŸ”Š TtsModule

**ìœ„ì¹˜:** `src/tts/`

### TtsService

AWS Pollyë¥¼ ì‚¬ìš©í•˜ì—¬ í…ìŠ¤íŠ¸ë¥¼ ìŒì„±ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

| ë©”ì„œë“œ | ì„¤ëª… |
|--------|------|
| `synthesize(text)` | í…ìŠ¤íŠ¸ë¥¼ MP3ë¡œ ë³€í™˜ |

**ì„¤ì •:**
- ìŒì„±: Seoyeon (í•œêµ­ì–´ ì—¬ì„±)
- ì—”ì§„: Neural (ê³ í’ˆì§ˆ)
- ì¶œë ¥: MP3

---

## ğŸ“Š ë ˆì´í„´ì‹œ ì°¸ê³ 

| ë‹¨ê³„ | í‰ê·  ì‹œê°„ | ë¹„ê³  |
|------|----------|------|
| STT | ~4.5ì´ˆ | 12ì´ˆ ì˜¤ë””ì˜¤ ê¸°ì¤€ |
| LLM | ~2.5ì´ˆ | ì‘ë‹µ ê¸¸ì´ì— ë”°ë¼ ë³€ë™ |
| TTS | ~1.2ì´ˆ | ì‘ë‹µ ê¸¸ì´ì— ë”°ë¼ ë³€ë™ |
| **ì´í•©** | ~8ì´ˆ | íŒŒì¼ í…ŒìŠ¤íŠ¸ ê¸°ì¤€ |

> ì‹¤ì‹œê°„ ë§ˆì´í¬ ì…ë ¥ ì‹œ STTê°€ ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ ì²´ê° ë ˆì´í„´ì‹œê°€ ì¤„ì–´ë“­ë‹ˆë‹¤.

---

## ğŸ”‘ AWS ê¶Œí•œ ìš”êµ¬ì‚¬í•­

IAM ì‚¬ìš©ìì—ê²Œ í•„ìš”í•œ ê¶Œí•œ:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "transcribe:StartStreamTranscription"
      ],
      "Resource": "*"
    },
    {
      "Effect": "Allow",
      "Action": [
        "bedrock:InvokeModel"
      ],
      "Resource": "*"
    },
    {
      "Effect": "Allow",
      "Action": [
        "polly:SynthesizeSpeech"
      ],
      "Resource": "*"
    }
  ]
}
```
